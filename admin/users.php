<?php
  ob_start();
  session_start();
  if (isset($_SESSION['admin']) )
  {

    $page = isset($_GET['page']) ? $_GET['page'] : 'manage';

    if ($page == 'manage')
    {
      $pageTitle = 'users management';
      include 'init.php';
      $ord = 'ASC';

      if (isset($_GET['ordering']))
      {
        $ord = $_GET['ordering'];
      }

      $users = AllItems($conn, 'users', $ord);


      ?>
      <div class="default-management-list users-management">
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <div class="page-direction-bnts">
                <ul>
                  <li>
                    <a href="users.php?page=manage">
                      <svg width="30" height="auto" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M7.28396 9.90375C7.98108 9.50966 8.52809 8.89583 8.83958 8.15808C9.15107 7.42034 9.2095 6.60022 9.00576 5.82576C8.80201 5.05131 8.34755 4.36612 7.71334 3.87718C7.07912 3.38824 6.30086 3.12307 5.50005 3.12307C4.69924 3.12307 3.92098 3.38824 3.28676 3.87718C2.65255 4.36612 2.19809 5.05131 1.99434 5.82576C1.79059 6.60022 1.84903 7.42034 2.16052 8.15808C2.472 8.89583 3.01902 9.50966 3.71614 9.90375C2.4938 10.2939 1.43232 11.0726 0.693143 12.1214C0.66479 12.1616 0.644646 12.2071 0.63386 12.2551C0.623074 12.3032 0.621859 12.3529 0.630283 12.4014C0.638707 12.4499 0.656606 12.4963 0.682957 12.5379C0.709308 12.5795 0.743596 12.6156 0.783862 12.6439C0.824129 12.6723 0.869586 12.6924 0.917637 12.7032C0.965689 12.714 1.01539 12.7152 1.06392 12.7068C1.11244 12.6983 1.15882 12.6804 1.20043 12.6541C1.24203 12.6277 1.27804 12.5935 1.30639 12.5532C1.77937 11.8803 2.4073 11.3312 3.13717 10.9521C3.86703 10.573 4.6774 10.3751 5.49984 10.375C6.32229 10.375 7.13267 10.5729 7.86256 10.9519C8.59245 11.331 9.22043 11.8801 9.69346 12.5529C9.72181 12.5931 9.75782 12.6274 9.79943 12.6538C9.84104 12.6801 9.88742 12.698 9.93595 12.7064C9.98447 12.7148 10.0342 12.7136 10.0822 12.7028C10.1303 12.692 10.1757 12.6719 10.216 12.6435C10.2562 12.6152 10.2905 12.5792 10.3169 12.5376C10.3432 12.4959 10.3611 12.4496 10.3695 12.401C10.378 12.3525 10.3767 12.3028 10.3659 12.2548C10.3552 12.2067 10.335 12.1613 10.3066 12.121C9.56748 11.0724 8.50613 10.2939 7.28396 9.90375V9.90375ZM2.62502 6.75C2.62502 6.18138 2.79363 5.62552 3.10954 5.15273C3.42545 4.67994 3.87447 4.31145 4.3998 4.09384C4.92514 3.87624 5.50321 3.81931 6.0609 3.93024C6.6186 4.04117 7.13087 4.31499 7.53295 4.71707C7.93503 5.11914 8.20884 5.63142 8.31978 6.18911C8.43071 6.74681 8.37377 7.32488 8.15617 7.85021C7.93857 8.37555 7.57007 8.82456 7.09728 9.14047C6.62449 9.45638 6.06864 9.625 5.50002 9.625C4.73779 9.62414 4.00702 9.32096 3.46804 8.78198C2.92906 8.243 2.62588 7.51223 2.62502 6.75V6.75ZM15.3111 12.6436C15.2708 12.6719 15.2254 12.6921 15.1773 12.7029C15.1293 12.7137 15.0796 12.7149 15.031 12.7065C14.9825 12.698 14.9361 12.6801 14.8945 12.6538C14.8529 12.6274 14.8169 12.5931 14.7886 12.5529C14.315 11.8807 13.6869 11.332 12.9572 10.953C12.2275 10.574 11.4174 10.3758 10.5951 10.375C10.4957 10.375 10.4003 10.3355 10.33 10.2652C10.2597 10.1948 10.2201 10.0995 10.2201 10C10.2201 9.90054 10.2597 9.80516 10.33 9.73483C10.4003 9.66451 10.4957 9.625 10.5951 9.625C11.0057 9.62457 11.4114 9.53622 11.785 9.36587C12.1585 9.19553 12.4913 8.94716 12.7608 8.63746C13.0304 8.32776 13.2304 7.96393 13.3476 7.57043C13.4648 7.17694 13.4963 6.76292 13.4401 6.35622C13.3838 5.94952 13.2411 5.55959 13.0216 5.21265C12.8021 4.86571 12.5108 4.56982 12.1673 4.34488C11.8238 4.11995 11.4362 3.97118 11.0304 3.9086C10.6246 3.84601 10.2102 3.87106 9.81489 3.98206C9.71915 4.009 9.61663 3.9968 9.52988 3.94814C9.44313 3.89949 9.37927 3.81837 9.35233 3.72262C9.32539 3.62688 9.3376 3.52436 9.38625 3.43761C9.4349 3.35086 9.51602 3.287 9.61177 3.26006C10.4648 3.01936 11.3765 3.09958 12.1743 3.48555C12.9722 3.87152 13.601 4.53648 13.9418 5.35467C14.2826 6.17287 14.3118 7.08759 14.0238 7.92584C13.7359 8.76409 13.1507 9.46778 12.3791 9.90381C13.6012 10.2939 14.6626 11.0725 15.4018 12.1211C15.459 12.2024 15.4816 12.3031 15.4646 12.4011C15.4476 12.4991 15.3924 12.5863 15.3111 12.6436V12.6436Z" fill="#8094ae"/>
                      </svg>
                      users</a>
                  </li>
                  <li>
                    <a href="dashboard.php">
                      <svg width="20" height="auto" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M3.73331 1.33334H3.66665C3.36131 1.33334 3.09865 1.33334 2.86665 1.388C2.50749 1.47382 2.17911 1.6574 1.91789 1.91839C1.65666 2.17938 1.47279 2.50759 1.38665 2.86667C1.33331 3.09867 1.33331 3.36 1.33331 3.66667V7C1.33331 7.30534 1.33331 7.568 1.38798 7.8C1.4738 8.15915 1.65737 8.48754 1.91837 8.74876C2.17936 9.00999 2.50757 9.19386 2.86665 9.28C3.09865 9.33334 3.35998 9.33334 3.66665 9.33334H6.99998C7.30531 9.33334 7.56798 9.33334 7.79998 9.27867C8.15913 9.19285 8.48751 9.00927 8.74874 8.74828C9.00996 8.48729 9.19384 8.15908 9.27998 7.8C9.33331 7.568 9.33331 7.30667 9.33331 7V3.66667C9.33331 3.36134 9.33331 3.09867 9.27865 2.86667C9.19283 2.50752 9.00925 2.17914 8.74826 1.91791C8.48727 1.65668 8.15905 1.47281 7.79998 1.38667C7.56798 1.33334 7.30665 1.33334 6.99998 1.33334H3.73331ZM3.17731 2.68534C3.23465 2.672 3.32398 2.66667 3.73331 2.66667H6.93331C7.34398 2.66667 7.43198 2.67067 7.48931 2.68534C7.60909 2.71398 7.71858 2.77524 7.80566 2.86232C7.89275 2.9494 7.954 3.0589 7.98265 3.17867C7.99598 3.23467 7.99998 3.32267 7.99998 3.73334V6.93334C7.99998 7.344 7.99598 7.432 7.98131 7.48934C7.95267 7.60911 7.89141 7.71861 7.80433 7.80569C7.71725 7.89277 7.60775 7.95403 7.48798 7.98267C7.43331 7.99467 7.34531 8 6.93331 8H3.73331C3.32265 8 3.23465 7.996 3.17731 7.98134C3.05754 7.95269 2.94804 7.89144 2.86096 7.80436C2.77388 7.71727 2.71262 7.60778 2.68398 7.488C2.67198 7.43334 2.66665 7.34534 2.66665 6.93334V3.73334C2.66665 3.32267 2.67065 3.23467 2.68531 3.17734C2.71395 3.05756 2.77521 2.94806 2.86229 2.86098C2.94937 2.7739 3.05887 2.71264 3.17865 2.684L3.17731 2.68534ZM13.0666 1.33334H13C12.6946 1.33334 12.432 1.33334 12.2 1.388C11.8408 1.47382 11.5124 1.6574 11.2512 1.91839C10.99 2.17938 10.8061 2.50759 10.72 2.86667C10.6666 3.09867 10.6666 3.36 10.6666 3.66667V7C10.6666 7.30534 10.6666 7.568 10.7213 7.8C10.8071 8.15915 10.9907 8.48754 11.2517 8.74876C11.5127 9.00999 11.8409 9.19386 12.2 9.28C12.432 9.33334 12.6933 9.33334 13 9.33334H16.3333C16.6386 9.33334 16.9013 9.33334 17.1333 9.27867C17.4925 9.19285 17.8208 9.00927 18.0821 8.74828C18.3433 8.48729 18.5272 8.15908 18.6133 7.8C18.6666 7.568 18.6666 7.30667 18.6666 7V3.66667C18.6666 3.36134 18.6666 3.09867 18.612 2.86667C18.5262 2.50752 18.3426 2.17914 18.0816 1.91791C17.8206 1.65668 17.4924 1.47281 17.1333 1.38667C16.9013 1.33334 16.64 1.33334 16.3333 1.33334H13.0666ZM12.5106 2.68534C12.568 2.672 12.6573 2.66667 13.0666 2.66667H16.2666C16.6773 2.66667 16.7653 2.67067 16.8226 2.68534C16.9424 2.71398 17.0519 2.77524 17.139 2.86232C17.2261 2.9494 17.2873 3.0589 17.316 3.17867C17.3293 3.23467 17.3333 3.32267 17.3333 3.73334V6.93334C17.3333 7.344 17.328 7.432 17.3146 7.48934C17.286 7.60911 17.2247 7.71861 17.1377 7.80569C17.0506 7.89277 16.9411 7.95403 16.8213 7.98267C16.7653 7.996 16.6773 8 16.2666 8H13.0666C12.656 8 12.568 7.996 12.5106 7.98134C12.3909 7.95269 12.2814 7.89144 12.1943 7.80436C12.1072 7.71727 12.046 7.60778 12.0173 7.488C12.0053 7.43334 12 7.34534 12 6.93334V3.73334C12 3.32267 12.004 3.23467 12.0186 3.17734C12.0473 3.05756 12.1085 2.94806 12.1956 2.86098C12.2827 2.7739 12.3922 2.71264 12.512 2.684L12.5106 2.68534ZM3.66665 10.6667H6.99998C7.30531 10.6667 7.56798 10.6667 7.79998 10.7213C8.15913 10.8072 8.48751 10.9907 8.74874 11.2517C9.00996 11.5127 9.19384 11.8409 9.27998 12.2C9.33331 12.432 9.33331 12.6933 9.33331 13V16.3333C9.33331 16.6387 9.33331 16.9013 9.27865 17.1333C9.19283 17.4925 9.00925 17.8209 8.74826 18.0821C8.48727 18.3433 8.15905 18.5272 7.79998 18.6133C7.56798 18.6667 7.30665 18.6667 6.99998 18.6667H3.66665C3.36131 18.6667 3.09865 18.6667 2.86665 18.612C2.50749 18.5262 2.17911 18.3426 1.91789 18.0816C1.65666 17.8206 1.47279 17.4924 1.38665 17.1333C1.33331 16.9013 1.33331 16.64 1.33331 16.3333V13C1.33331 12.6947 1.33331 12.432 1.38798 12.2C1.4738 11.8409 1.65737 11.5125 1.91837 11.2512C2.17936 10.99 2.50757 10.8061 2.86665 10.72C3.09865 10.6667 3.35998 10.6667 3.66665 10.6667ZM3.73331 12C3.32265 12 3.23465 12.004 3.17731 12.0187C3.05754 12.0473 2.94804 12.1086 2.86096 12.1956C2.77388 12.2827 2.71262 12.3922 2.68398 12.512C2.67198 12.5667 2.66665 12.6547 2.66665 13.0667V16.2667C2.66665 16.6773 2.67065 16.7653 2.68531 16.8227C2.71395 16.9424 2.77521 17.0519 2.86229 17.139C2.94937 17.2261 3.05887 17.2874 3.17865 17.316C3.23465 17.3293 3.32265 17.3333 3.73331 17.3333H6.93331C7.34398 17.3333 7.43198 17.328 7.48931 17.3147C7.60909 17.286 7.71858 17.2248 7.80566 17.1377C7.89275 17.0506 7.954 16.9411 7.98265 16.8213C7.99598 16.7653 7.99998 16.6773 7.99998 16.2667V13.0667C7.99998 12.656 7.99598 12.568 7.98131 12.5107C7.95267 12.3909 7.89141 12.2814 7.80433 12.1943C7.71725 12.1072 7.60775 12.046 7.48798 12.0173C7.43331 12.0053 7.34531 12 6.93331 12H3.73331ZM13.0666 10.6667H13C12.6946 10.6667 12.432 10.6667 12.2 10.7213C11.8408 10.8072 11.5124 10.9907 11.2512 11.2517C10.99 11.5127 10.8061 11.8409 10.72 12.2C10.6666 12.432 10.6666 12.6933 10.6666 13V16.3333C10.6666 16.6387 10.6666 16.9013 10.7213 17.1333C10.8071 17.4925 10.9907 17.8209 11.2517 18.0821C11.5127 18.3433 11.8409 18.5272 12.2 18.6133C12.432 18.668 12.6946 18.668 13 18.668H16.3333C16.6386 18.668 16.9013 18.668 17.1333 18.6133C17.4922 18.5273 17.8203 18.3436 18.0813 18.0827C18.3423 17.8217 18.5259 17.4936 18.612 17.1347C18.6666 16.9027 18.6666 16.64 18.6666 16.3347V13C18.6666 12.6947 18.6666 12.432 18.612 12.2C18.5262 11.8409 18.3426 11.5125 18.0816 11.2512C17.8206 10.99 17.4924 10.8061 17.1333 10.72C16.9013 10.6667 16.64 10.6667 16.3333 10.6667H13.0666ZM12.5106 12.0187C12.568 12.0053 12.6573 12 13.0666 12H16.2666C16.6773 12 16.7653 12.004 16.8226 12.0187C16.9424 12.0473 17.0519 12.1086 17.139 12.1956C17.2261 12.2827 17.2873 12.3922 17.316 12.512C17.3293 12.568 17.3333 12.656 17.3333 13.0667V16.2667C17.3333 16.6773 17.328 16.7653 17.3146 16.8227C17.286 16.9424 17.2247 17.0519 17.1377 17.139C17.0506 17.2261 16.9411 17.2874 16.8213 17.316C16.7653 17.3293 16.6773 17.3333 16.2666 17.3333H13.0666C12.656 17.3333 12.568 17.328 12.5106 17.3147C12.3909 17.286 12.2814 17.2248 12.1943 17.1377C12.1072 17.0506 12.046 16.9411 12.0173 16.8213C12.0053 16.7667 12 16.6787 12 16.2667V13.0667C12 12.656 12.004 12.568 12.0186 12.5107C12.0473 12.3909 12.1085 12.2814 12.1956 12.1943C12.2827 12.1072 12.3922 12.046 12.512 12.0173L12.5106 12.0187Z" fill="#8094ae"/>
                      </svg>
                    dashboard</a>
                  </li>

                </ul>
              </div>
            </div>


            <div class="col-md-6">
              <div class="left-header management-header">
                <h1>users list</h1>
                <p class="tt">total users <?php echo Total($conn, 'users') ?> user.</p>
              </div>
            </div>
            <div class="col-md-6">
              <div class="right-header management-header">
                <?php
                    if($_SESSION['type'] == 2)
                    {
                        ?>
                        <div class="btns">
                          <span id="open-add-page" class="add-btn"><i class="fas fa-plus"></i> add user</span>

                        </div>
                        <?php
                    }
                 ?>
              </div>
            </div>
            <div class="col-md-6 srch-sp">
              <div class="search-box">
                <input type="search" class="form-control" name="search" id="users-search" autocomplete="off" onkeyup="tableone()" placeholder="search by username">
              </div>
            </div>
            <div class="col-md-6">
              <div class="ordering">
                <ul>
                  <li class=" dropdown">
                          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            order <i class="fas fa-sort"></i>
                          </a>
                          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="users.php?page=manage&ordering=ASC">

                              ASC
                            </a>

                            <a class="dropdown-item" href="users.php?page=manage&ordering=DESC">
                              DESC
                            </a>
                          </div>
                        </li>
                </ul>
              </div>
            </div>
            <div class="col-md-12">
              <div class="management-body">
                <div class="default-management-table">
                  <table class="table" id="users-table">
                    <thead>
                      <tr>
                        <th scope="col">id</th>
                        <th scope="col">avatar</th>
                        <th scope="col">full name</th>
                        <th scope="col">username</th>
                        <th scope="col">email</th>
                        <th scope="col">type</th>
                        <th scope="col">points</th>
                        <th scope="col">clicks</th>

                        <th scope="col">action</th>

                      </tr>
                    </thead>
                    <tbody>

                      <?php
                      foreach($users as $user)
                      {
                        ?>
                        <tr>
                          <td>
                            <p><?php echo $user['id'] ?></p>
                          </td>
                          <td>
                            <div class="avatar">
                              <?php
                                  if (empty($user['image']))
                                  {
                                    ?>
                                    <img src="<?php echo $avatar  ?>default.png" alt="avart" style="width:40px">

                                    <?php
                                  }
                                  if (!empty($user['image']))
                                  {
                                    ?>
                                    <img src="<?php echo $avatar . $user['image']  ?>" alt="avart" style="width:40px">

                                    <?php
                                  }
                               ?>
                            </div>
                          </td>
                          <td>
                            <p class="f-n"><?php echo $user['fname']; ?></p>
                          </td>
                          <td>
                            <p class="u-s"><?php
                              echo $user['username']
                             ?></p>
                          </td>
                          <td>
                            <p class="e-m"><?php echo $user['email'] ?></p>
                          </td>

                          <td>
                            <?php


                              if ($user['type'] == 1)
                              {
                                ?>
                                <span class="type e-ty" style="background:grey">editor</span>
                                <?php
                              }
                              if ($user['type'] == 0)
                              {
                                ?>
                                <span class="type e-ty" style="background:#1d8a47">client</span>
                                <?php
                              }
                              if ($user['type'] == 2)
                              {
                                ?>
                                <span class="type a-ty">admin</span>
                                <?php
                              }
                             ?>

                          </td>
<td>
  <span class="type e-ty" style="background:blue;font-size:12px"><?php echo $user['points'] ?> point</span>

</td>

<td>
  <span class="type e-ty" style="background:orange;font-size:12px"><?php echo $user['hits'] ?></span>

</td>
                          <td>
                            <?php
                              if ($_SESSION['type'] == 2 )
                              {
                                  ?>
                                  <ul>
                                    <li class=" dropdown">
                                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                              <i class="fas fa-ellipsis-h"></i>
                                            </a>
                                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                              <a class="dropdown-item" href="users.php?page=edit&id=<?php echo $user['id'] ?>">
                                                <svg width="20" height="auto" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M11 10C11.3774 9.99976 11.7472 10.1063 12.0666 10.3073C12.386 10.5084 12.642 10.7956 12.805 11.136L11.998 11.943C11.9834 11.6881 11.872 11.4485 11.6864 11.2731C11.5009 11.0978 11.2553 11.0001 11 11H4C3.73478 11 3.48043 11.1054 3.29289 11.2929C3.10536 11.4804 3 11.7348 3 12V13.5C3 14.907 4.579 16 7.5 16C8.154 16 8.74 15.945 9.258 15.844L9.055 16.654C9.035 16.734 9.02 16.816 9.011 16.896C8.542 16.964 8.037 17 7.5 17C4.088 17 2 15.554 2 13.5V12C2 11.4696 2.21071 10.9609 2.58579 10.5858C2.96086 10.2107 3.46957 10 4 10H11Z" fill="black"/>
                                                <path d="M15.807 9.548C15.9807 9.37432 16.1869 9.23656 16.4138 9.14257C16.6407 9.04858 16.8839 9.0002 17.1295 9.0002C17.3751 9.0002 17.6183 9.04858 17.8453 9.14257C18.0722 9.23656 18.2784 9.37432 18.452 9.548C18.6257 9.72167 18.7635 9.92785 18.8575 10.1548C18.9514 10.3817 18.9998 10.6249 18.9998 10.8705C18.9998 11.1161 18.9514 11.3593 18.8575 11.5862C18.7635 11.8131 18.6257 12.0193 18.452 12.193L13.622 17.022C13.3407 17.3035 12.9881 17.5033 12.602 17.6L11.104 17.974C10.9551 18.0109 10.7992 18.0087 10.6515 17.9676C10.5037 17.9265 10.369 17.8479 10.2606 17.7395C10.1521 17.631 10.0735 17.4963 10.0324 17.3486C9.99132 17.2008 9.98912 17.0449 10.026 16.896L10.4 15.398C10.497 15.012 10.696 14.658 10.978 14.378L15.808 9.548H15.807Z" fill="black"/>
                                                <path d="M14.5 9C14.8283 9.00013 15.1535 8.93556 15.4569 8.80997C15.7602 8.68438 16.0359 8.50023 16.2681 8.26806C16.5002 8.03589 16.6844 7.76024 16.81 7.45687C16.9356 7.15349 17.0001 6.82834 17 6.5C17 6.00555 16.8534 5.5222 16.5787 5.11108C16.304 4.69995 15.9135 4.37952 15.4567 4.1903C14.9999 4.00108 14.4972 3.95157 14.0123 4.04804C13.5273 4.1445 13.0819 4.3826 12.7322 4.73223C12.3826 5.08187 12.1445 5.52732 12.048 6.01228C11.9516 6.49723 12.0011 6.99989 12.1903 7.45671C12.3795 7.91353 12.7 8.30397 13.1111 8.57868C13.5222 8.85338 14.0055 9 14.5 9ZM14.5 5C14.8978 5 15.2794 5.15804 15.5607 5.43934C15.842 5.72065 16 6.10218 16 6.5C16 6.89783 15.842 7.27936 15.5607 7.56066C15.2794 7.84197 14.8978 8 14.5 8C14.1022 8 13.7206 7.84197 13.4393 7.56066C13.158 7.27936 13 6.89783 13 6.5C13 6.10218 13.158 5.72065 13.4393 5.43934C13.7206 5.15804 14.1022 5 14.5 5Z" fill="black"/>
                                                <path d="M7.5 2C7.95963 2 8.41475 2.09053 8.83939 2.26642C9.26403 2.44231 9.64987 2.70012 9.97487 3.02513C10.2999 3.35013 10.5577 3.73597 10.7336 4.16061C10.9095 4.58525 11 5.04037 11 5.5C11 5.95963 10.9095 6.41475 10.7336 6.83939C10.5577 7.26403 10.2999 7.64987 9.97487 7.97487C9.64987 8.29988 9.26403 8.55769 8.83939 8.73358C8.41475 8.90947 7.95963 9 7.5 9C6.57174 9 5.6815 8.63125 5.02513 7.97487C4.36875 7.3185 4 6.42826 4 5.5C4 4.57174 4.36875 3.6815 5.02513 3.02513C5.6815 2.36875 6.57174 2 7.5 2V2ZM7.5 3C6.83696 3 6.20107 3.26339 5.73223 3.73223C5.26339 4.20107 5 4.83696 5 5.5C5 6.16304 5.26339 6.79893 5.73223 7.26777C6.20107 7.73661 6.83696 8 7.5 8C8.16304 8 8.79893 7.73661 9.26777 7.26777C9.73661 6.79893 10 6.16304 10 5.5C10 4.83696 9.73661 4.20107 9.26777 3.73223C8.79893 3.26339 8.16304 3 7.5 3Z" fill="black"/>
                                                </svg>

                                              edit user
                                              </a>

                                              <div class="dropdown-divider"></div>
                                              <a class="dropdown-item" href="users.php?page=delete&id=<?php echo $user['id'] ?>">
                                                <svg width="24" height="auto" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M20.47 7.5L21.2 6.77C21.3949 6.57507 21.5044 6.31068 21.5044 6.035C21.5044 5.75932 21.3949 5.49494 21.2 5.3C21.0051 5.10507 20.7407 4.99555 20.465 4.99555C20.1893 4.99555 19.9249 5.10507 19.73 5.3L19 6L18.27 5.27C18.0711 5.07507 17.8029 4.96714 17.5244 4.96995C17.2459 4.97276 16.9799 5.08609 16.785 5.285C16.5901 5.48391 16.4821 5.75212 16.4849 6.03061C16.4878 6.3091 16.6011 6.57507 16.8 6.77L17.53 7.5L16.8 8.23C16.6051 8.42494 16.4956 8.68932 16.4956 8.965C16.4956 9.24068 16.6051 9.50507 16.8 9.7C16.9949 9.89494 17.2593 10.0044 17.535 10.0044C17.8107 10.0044 18.0751 9.89494 18.27 9.7L19 9L19.73 9.73C19.9289 9.92494 20.1971 10.0329 20.4756 10.0301C20.7541 10.0272 21.0201 9.91391 21.215 9.715C21.4099 9.51609 21.5179 9.24789 21.5151 8.9694C21.5122 8.6909 21.3989 8.42494 21.2 8.23L20.47 7.5ZM10 11C10.7911 11 11.5645 10.7654 12.2223 10.3259C12.8801 9.88635 13.3928 9.26164 13.6955 8.53074C13.9983 7.79983 14.0775 6.99556 13.9231 6.21964C13.7688 5.44372 13.3878 4.73098 12.8284 4.17157C12.269 3.61216 11.5563 3.2312 10.7804 3.07686C10.0044 2.92252 9.20017 3.00173 8.46927 3.30448C7.73836 3.60723 7.11365 4.11992 6.67412 4.77772C6.2346 5.43552 6 6.20888 6 7C6 8.06087 6.42143 9.07828 7.17157 9.82843C7.92172 10.5786 8.93913 11 10 11ZM10 5C10.3956 5 10.7822 5.1173 11.1111 5.33706C11.44 5.55683 11.6964 5.86918 11.8478 6.23463C11.9991 6.60009 12.0387 7.00222 11.9616 7.39018C11.8844 7.77814 11.6939 8.13451 11.4142 8.41422C11.1345 8.69392 10.7781 8.8844 10.3902 8.96157C10.0022 9.03874 9.60009 8.99914 9.23463 8.84776C8.86918 8.69639 8.55682 8.44004 8.33706 8.11114C8.1173 7.78224 8 7.39556 8 7C8 6.46957 8.21071 5.96086 8.58579 5.58579C8.96086 5.21072 9.46957 5 10 5ZM10 13C8.14348 13 6.36301 13.7375 5.05025 15.0503C3.7375 16.363 3 18.1435 3 20C3 20.2652 3.10536 20.5196 3.29289 20.7071C3.48043 20.8946 3.73478 21 4 21C4.26522 21 4.51957 20.8946 4.70711 20.7071C4.89464 20.5196 5 20.2652 5 20C5 18.6739 5.52678 17.4021 6.46447 16.4645C7.40215 15.5268 8.67392 15 10 15C11.3261 15 12.5979 15.5268 13.5355 16.4645C14.4732 17.4021 15 18.6739 15 20C15 20.2652 15.1054 20.5196 15.2929 20.7071C15.4804 20.8946 15.7348 21 16 21C16.2652 21 16.5196 20.8946 16.7071 20.7071C16.8946 20.5196 17 20.2652 17 20C17 18.1435 16.2625 16.363 14.9497 15.0503C13.637 13.7375 11.8565 13 10 13Z" fill="black"/>
                                                </svg>

                                              delete user
                                              </a>
                                            </div>
                                          </li>
                                  </ul>
                                  <?php
                              }


                              elseif ($_SESSION['id'] == $user['id'] )
                              {
                                ?>
                                <ul>
                                  <li class=" dropdown">
                                          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <i class="fas fa-ellipsis-h"></i>
                                          </a>
                                          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                            <a class="dropdown-item" href="users.php?page=edit&id=<?php echo $user['id'] ?>">
                                              <svg width="20" height="auto" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                              <path d="M11 10C11.3774 9.99976 11.7472 10.1063 12.0666 10.3073C12.386 10.5084 12.642 10.7956 12.805 11.136L11.998 11.943C11.9834 11.6881 11.872 11.4485 11.6864 11.2731C11.5009 11.0978 11.2553 11.0001 11 11H4C3.73478 11 3.48043 11.1054 3.29289 11.2929C3.10536 11.4804 3 11.7348 3 12V13.5C3 14.907 4.579 16 7.5 16C8.154 16 8.74 15.945 9.258 15.844L9.055 16.654C9.035 16.734 9.02 16.816 9.011 16.896C8.542 16.964 8.037 17 7.5 17C4.088 17 2 15.554 2 13.5V12C2 11.4696 2.21071 10.9609 2.58579 10.5858C2.96086 10.2107 3.46957 10 4 10H11Z" fill="black"/>
                                              <path d="M15.807 9.548C15.9807 9.37432 16.1869 9.23656 16.4138 9.14257C16.6407 9.04858 16.8839 9.0002 17.1295 9.0002C17.3751 9.0002 17.6183 9.04858 17.8453 9.14257C18.0722 9.23656 18.2784 9.37432 18.452 9.548C18.6257 9.72167 18.7635 9.92785 18.8575 10.1548C18.9514 10.3817 18.9998 10.6249 18.9998 10.8705C18.9998 11.1161 18.9514 11.3593 18.8575 11.5862C18.7635 11.8131 18.6257 12.0193 18.452 12.193L13.622 17.022C13.3407 17.3035 12.9881 17.5033 12.602 17.6L11.104 17.974C10.9551 18.0109 10.7992 18.0087 10.6515 17.9676C10.5037 17.9265 10.369 17.8479 10.2606 17.7395C10.1521 17.631 10.0735 17.4963 10.0324 17.3486C9.99132 17.2008 9.98912 17.0449 10.026 16.896L10.4 15.398C10.497 15.012 10.696 14.658 10.978 14.378L15.808 9.548H15.807Z" fill="black"/>
                                              <path d="M14.5 9C14.8283 9.00013 15.1535 8.93556 15.4569 8.80997C15.7602 8.68438 16.0359 8.50023 16.2681 8.26806C16.5002 8.03589 16.6844 7.76024 16.81 7.45687C16.9356 7.15349 17.0001 6.82834 17 6.5C17 6.00555 16.8534 5.5222 16.5787 5.11108C16.304 4.69995 15.9135 4.37952 15.4567 4.1903C14.9999 4.00108 14.4972 3.95157 14.0123 4.04804C13.5273 4.1445 13.0819 4.3826 12.7322 4.73223C12.3826 5.08187 12.1445 5.52732 12.048 6.01228C11.9516 6.49723 12.0011 6.99989 12.1903 7.45671C12.3795 7.91353 12.7 8.30397 13.1111 8.57868C13.5222 8.85338 14.0055 9 14.5 9ZM14.5 5C14.8978 5 15.2794 5.15804 15.5607 5.43934C15.842 5.72065 16 6.10218 16 6.5C16 6.89783 15.842 7.27936 15.5607 7.56066C15.2794 7.84197 14.8978 8 14.5 8C14.1022 8 13.7206 7.84197 13.4393 7.56066C13.158 7.27936 13 6.89783 13 6.5C13 6.10218 13.158 5.72065 13.4393 5.43934C13.7206 5.15804 14.1022 5 14.5 5Z" fill="black"/>
                                              <path d="M7.5 2C7.95963 2 8.41475 2.09053 8.83939 2.26642C9.26403 2.44231 9.64987 2.70012 9.97487 3.02513C10.2999 3.35013 10.5577 3.73597 10.7336 4.16061C10.9095 4.58525 11 5.04037 11 5.5C11 5.95963 10.9095 6.41475 10.7336 6.83939C10.5577 7.26403 10.2999 7.64987 9.97487 7.97487C9.64987 8.29988 9.26403 8.55769 8.83939 8.73358C8.41475 8.90947 7.95963 9 7.5 9C6.57174 9 5.6815 8.63125 5.02513 7.97487C4.36875 7.3185 4 6.42826 4 5.5C4 4.57174 4.36875 3.6815 5.02513 3.02513C5.6815 2.36875 6.57174 2 7.5 2V2ZM7.5 3C6.83696 3 6.20107 3.26339 5.73223 3.73223C5.26339 4.20107 5 4.83696 5 5.5C5 6.16304 5.26339 6.79893 5.73223 7.26777C6.20107 7.73661 6.83696 8 7.5 8C8.16304 8 8.79893 7.73661 9.26777 7.26777C9.73661 6.79893 10 6.16304 10 5.5C10 4.83696 9.73661 4.20107 9.26777 3.73223C8.79893 3.26339 8.16304 3 7.5 3Z" fill="black"/>
                                              </svg>

                                              edit user
                                            </a>

                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item" href="users.php?page=delete&id=<?php echo $user['id'] ?>">
                                              <svg width="24" height="auto" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                              <path d="M20.47 7.5L21.2 6.77C21.3949 6.57507 21.5044 6.31068 21.5044 6.035C21.5044 5.75932 21.3949 5.49494 21.2 5.3C21.0051 5.10507 20.7407 4.99555 20.465 4.99555C20.1893 4.99555 19.9249 5.10507 19.73 5.3L19 6L18.27 5.27C18.0711 5.07507 17.8029 4.96714 17.5244 4.96995C17.2459 4.97276 16.9799 5.08609 16.785 5.285C16.5901 5.48391 16.4821 5.75212 16.4849 6.03061C16.4878 6.3091 16.6011 6.57507 16.8 6.77L17.53 7.5L16.8 8.23C16.6051 8.42494 16.4956 8.68932 16.4956 8.965C16.4956 9.24068 16.6051 9.50507 16.8 9.7C16.9949 9.89494 17.2593 10.0044 17.535 10.0044C17.8107 10.0044 18.0751 9.89494 18.27 9.7L19 9L19.73 9.73C19.9289 9.92494 20.1971 10.0329 20.4756 10.0301C20.7541 10.0272 21.0201 9.91391 21.215 9.715C21.4099 9.51609 21.5179 9.24789 21.5151 8.9694C21.5122 8.6909 21.3989 8.42494 21.2 8.23L20.47 7.5ZM10 11C10.7911 11 11.5645 10.7654 12.2223 10.3259C12.8801 9.88635 13.3928 9.26164 13.6955 8.53074C13.9983 7.79983 14.0775 6.99556 13.9231 6.21964C13.7688 5.44372 13.3878 4.73098 12.8284 4.17157C12.269 3.61216 11.5563 3.2312 10.7804 3.07686C10.0044 2.92252 9.20017 3.00173 8.46927 3.30448C7.73836 3.60723 7.11365 4.11992 6.67412 4.77772C6.2346 5.43552 6 6.20888 6 7C6 8.06087 6.42143 9.07828 7.17157 9.82843C7.92172 10.5786 8.93913 11 10 11ZM10 5C10.3956 5 10.7822 5.1173 11.1111 5.33706C11.44 5.55683 11.6964 5.86918 11.8478 6.23463C11.9991 6.60009 12.0387 7.00222 11.9616 7.39018C11.8844 7.77814 11.6939 8.13451 11.4142 8.41422C11.1345 8.69392 10.7781 8.8844 10.3902 8.96157C10.0022 9.03874 9.60009 8.99914 9.23463 8.84776C8.86918 8.69639 8.55682 8.44004 8.33706 8.11114C8.1173 7.78224 8 7.39556 8 7C8 6.46957 8.21071 5.96086 8.58579 5.58579C8.96086 5.21072 9.46957 5 10 5ZM10 13C8.14348 13 6.36301 13.7375 5.05025 15.0503C3.7375 16.363 3 18.1435 3 20C3 20.2652 3.10536 20.5196 3.29289 20.7071C3.48043 20.8946 3.73478 21 4 21C4.26522 21 4.51957 20.8946 4.70711 20.7071C4.89464 20.5196 5 20.2652 5 20C5 18.6739 5.52678 17.4021 6.46447 16.4645C7.40215 15.5268 8.67392 15 10 15C11.3261 15 12.5979 15.5268 13.5355 16.4645C14.4732 17.4021 15 18.6739 15 20C15 20.2652 15.1054 20.5196 15.2929 20.7071C15.4804 20.8946 15.7348 21 16 21C16.2652 21 16.5196 20.8946 16.7071 20.7071C16.8946 20.5196 17 20.2652 17 20C17 18.1435 16.2625 16.363 14.9497 15.0503C13.637 13.7375 11.8565 13 10 13Z" fill="black"/>
                                              </svg>

                                          delete user
                                            </a>
                                          </div>
                                        </li>
                                </ul>
                                <?php
                              }
                              else
                              {
                                echo 'You do not have access to this content';
                              }
                             ?>

                          </td>

                        </tr>
                        <tr>

                        <?php
                      }
                       ?>



                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    <?php

          if ($_SESSION['type'] == 2)
          {
            ?>
            <div class="add-default-page add-user-page" id="add-page">
              <div class="container">
                <div class="row justify-content-center">
                  <div class="col-md-6">
                    <form class="add-fomr" method="POST" action="insert_user.php" id="form-info"  >
                      <span class="fas fa-times" id="close"></span>
                      <h3>add new user <i class="fas fa-plus"></i>  </h3>

                        <div class="row">
                          <div class="col-6">
                            <label for="username">username</label>
                            <input type="text" name="username" id="username" placeholder="username" class="form-control">
                          </div>
                          <div class="col-6">
                            <label for="email">email </label>
                            <input type="text" name="email" id="email" placeholder="email" class="form-control">
                          </div>
                          <div class="col-12">
                            <label for="fname">
                               full name</label>
                            <input type="text" name="fname" id="fname" placeholder="full name" class="form-control">
                          </div>

                          <div class="col-6">
                            <label for="password"> password</label>
                            <input type="password" name="npassword" placeholder="password" class="form-control">
                          </div>
                          <div class="col-6">
                            <label for="cpassword">confirm password</label>
                            <input type="password" name="cpassword" placeholder="confirm password" class="form-control">
                          </div>
                          <div class="col-12">
                            <label for="type">user type </label>
                            <select class="form-control" name="type">
                              <option value="default" selected>select user type</option>
                              <option value="0">client</option>
                              <option value="1">editor</option>


                                                <option value="2">admin</option>
                            </select>

                          </div>

                        </div>
                      <input type="button" class="btn btn-primary" id="a-btn-option"  value="add">
                      <div class="err-msg">

                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
            <?php
          }
     ?>
      <?php
      include $tpl . 'footer.php';

    }elseif ($page == 'edit') {
      $pageTitle = "edit account";
      include 'init.php';

      $id = isset($_GET['id']) && is_numeric($_GET['id']) ? intval($_GET['id']) : header('location: users.php');
      $stmt = $conn->prepare("SELECT * FROM users WHERE id = ? LIMIT 1");
      $stmt->execute(array($id));
      $checkIfuserExist = $stmt->rowCount();
      $userInfo = $stmt->fetch();
      if ($checkIfuserExist > 0)
      {

        if ($_SESSION['type'] == 2 or $_SESSION['id'] == $userInfo['id'])
        {

          ?>
          <div class="edit-page user-edit-pages deep-page">
            <div class="container">
              <div class="row">
                <div class="col-md-12">
                  <div class="pg-tt">
                    <h1 style="display:block;text-align:left">edit user <?php echo $userInfo['fname'] ?></h1>
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="page-direction-bnts">
                    <ul>
                      <li>
                        <a href="users.php?page=edit&id=<?php echo $userInfo['id'] ?>">

                          <?php echo $userInfo['fname'] ?> </a>
                      </li>
                      <li>
                        <a href="users.php?page=manage">
                          <svg width="30" height="auto" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.28396 9.90375C7.98108 9.50966 8.52809 8.89583 8.83958 8.15808C9.15107 7.42034 9.2095 6.60022 9.00576 5.82576C8.80201 5.05131 8.34755 4.36612 7.71334 3.87718C7.07912 3.38824 6.30086 3.12307 5.50005 3.12307C4.69924 3.12307 3.92098 3.38824 3.28676 3.87718C2.65255 4.36612 2.19809 5.05131 1.99434 5.82576C1.79059 6.60022 1.84903 7.42034 2.16052 8.15808C2.472 8.89583 3.01902 9.50966 3.71614 9.90375C2.4938 10.2939 1.43232 11.0726 0.693143 12.1214C0.66479 12.1616 0.644646 12.2071 0.63386 12.2551C0.623074 12.3032 0.621859 12.3529 0.630283 12.4014C0.638707 12.4499 0.656606 12.4963 0.682957 12.5379C0.709308 12.5795 0.743596 12.6156 0.783862 12.6439C0.824129 12.6723 0.869586 12.6924 0.917637 12.7032C0.965689 12.714 1.01539 12.7152 1.06392 12.7068C1.11244 12.6983 1.15882 12.6804 1.20043 12.6541C1.24203 12.6277 1.27804 12.5935 1.30639 12.5532C1.77937 11.8803 2.4073 11.3312 3.13717 10.9521C3.86703 10.573 4.6774 10.3751 5.49984 10.375C6.32229 10.375 7.13267 10.5729 7.86256 10.9519C8.59245 11.331 9.22043 11.8801 9.69346 12.5529C9.72181 12.5931 9.75782 12.6274 9.79943 12.6538C9.84104 12.6801 9.88742 12.698 9.93595 12.7064C9.98447 12.7148 10.0342 12.7136 10.0822 12.7028C10.1303 12.692 10.1757 12.6719 10.216 12.6435C10.2562 12.6152 10.2905 12.5792 10.3169 12.5376C10.3432 12.4959 10.3611 12.4496 10.3695 12.401C10.378 12.3525 10.3767 12.3028 10.3659 12.2548C10.3552 12.2067 10.335 12.1613 10.3066 12.121C9.56748 11.0724 8.50613 10.2939 7.28396 9.90375V9.90375ZM2.62502 6.75C2.62502 6.18138 2.79363 5.62552 3.10954 5.15273C3.42545 4.67994 3.87447 4.31145 4.3998 4.09384C4.92514 3.87624 5.50321 3.81931 6.0609 3.93024C6.6186 4.04117 7.13087 4.31499 7.53295 4.71707C7.93503 5.11914 8.20884 5.63142 8.31978 6.18911C8.43071 6.74681 8.37377 7.32488 8.15617 7.85021C7.93857 8.37555 7.57007 8.82456 7.09728 9.14047C6.62449 9.45638 6.06864 9.625 5.50002 9.625C4.73779 9.62414 4.00702 9.32096 3.46804 8.78198C2.92906 8.243 2.62588 7.51223 2.62502 6.75V6.75ZM15.3111 12.6436C15.2708 12.6719 15.2254 12.6921 15.1773 12.7029C15.1293 12.7137 15.0796 12.7149 15.031 12.7065C14.9825 12.698 14.9361 12.6801 14.8945 12.6538C14.8529 12.6274 14.8169 12.5931 14.7886 12.5529C14.315 11.8807 13.6869 11.332 12.9572 10.953C12.2275 10.574 11.4174 10.3758 10.5951 10.375C10.4957 10.375 10.4003 10.3355 10.33 10.2652C10.2597 10.1948 10.2201 10.0995 10.2201 10C10.2201 9.90054 10.2597 9.80516 10.33 9.73483C10.4003 9.66451 10.4957 9.625 10.5951 9.625C11.0057 9.62457 11.4114 9.53622 11.785 9.36587C12.1585 9.19553 12.4913 8.94716 12.7608 8.63746C13.0304 8.32776 13.2304 7.96393 13.3476 7.57043C13.4648 7.17694 13.4963 6.76292 13.4401 6.35622C13.3838 5.94952 13.2411 5.55959 13.0216 5.21265C12.8021 4.86571 12.5108 4.56982 12.1673 4.34488C11.8238 4.11995 11.4362 3.97118 11.0304 3.9086C10.6246 3.84601 10.2102 3.87106 9.81489 3.98206C9.71915 4.009 9.61663 3.9968 9.52988 3.94814C9.44313 3.89949 9.37927 3.81837 9.35233 3.72262C9.32539 3.62688 9.3376 3.52436 9.38625 3.43761C9.4349 3.35086 9.51602 3.287 9.61177 3.26006C10.4648 3.01936 11.3765 3.09958 12.1743 3.48555C12.9722 3.87152 13.601 4.53648 13.9418 5.35467C14.2826 6.17287 14.3118 7.08759 14.0238 7.92584C13.7359 8.76409 13.1507 9.46778 12.3791 9.90381C13.6012 10.2939 14.6626 11.0725 15.4018 12.1211C15.459 12.2024 15.4816 12.3031 15.4646 12.4011C15.4476 12.4991 15.3924 12.5863 15.3111 12.6436V12.6436Z" fill="#8094ae"/>
                          </svg>
                          users</a>
                      </li>
                      <li>
                        <a href="dashboard.php">
                          <svg width="20" height="auto" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path fill-rule="evenodd" clip-rule="evenodd" d="M3.73331 1.33334H3.66665C3.36131 1.33334 3.09865 1.33334 2.86665 1.388C2.50749 1.47382 2.17911 1.6574 1.91789 1.91839C1.65666 2.17938 1.47279 2.50759 1.38665 2.86667C1.33331 3.09867 1.33331 3.36 1.33331 3.66667V7C1.33331 7.30534 1.33331 7.568 1.38798 7.8C1.4738 8.15915 1.65737 8.48754 1.91837 8.74876C2.17936 9.00999 2.50757 9.19386 2.86665 9.28C3.09865 9.33334 3.35998 9.33334 3.66665 9.33334H6.99998C7.30531 9.33334 7.56798 9.33334 7.79998 9.27867C8.15913 9.19285 8.48751 9.00927 8.74874 8.74828C9.00996 8.48729 9.19384 8.15908 9.27998 7.8C9.33331 7.568 9.33331 7.30667 9.33331 7V3.66667C9.33331 3.36134 9.33331 3.09867 9.27865 2.86667C9.19283 2.50752 9.00925 2.17914 8.74826 1.91791C8.48727 1.65668 8.15905 1.47281 7.79998 1.38667C7.56798 1.33334 7.30665 1.33334 6.99998 1.33334H3.73331ZM3.17731 2.68534C3.23465 2.672 3.32398 2.66667 3.73331 2.66667H6.93331C7.34398 2.66667 7.43198 2.67067 7.48931 2.68534C7.60909 2.71398 7.71858 2.77524 7.80566 2.86232C7.89275 2.9494 7.954 3.0589 7.98265 3.17867C7.99598 3.23467 7.99998 3.32267 7.99998 3.73334V6.93334C7.99998 7.344 7.99598 7.432 7.98131 7.48934C7.95267 7.60911 7.89141 7.71861 7.80433 7.80569C7.71725 7.89277 7.60775 7.95403 7.48798 7.98267C7.43331 7.99467 7.34531 8 6.93331 8H3.73331C3.32265 8 3.23465 7.996 3.17731 7.98134C3.05754 7.95269 2.94804 7.89144 2.86096 7.80436C2.77388 7.71727 2.71262 7.60778 2.68398 7.488C2.67198 7.43334 2.66665 7.34534 2.66665 6.93334V3.73334C2.66665 3.32267 2.67065 3.23467 2.68531 3.17734C2.71395 3.05756 2.77521 2.94806 2.86229 2.86098C2.94937 2.7739 3.05887 2.71264 3.17865 2.684L3.17731 2.68534ZM13.0666 1.33334H13C12.6946 1.33334 12.432 1.33334 12.2 1.388C11.8408 1.47382 11.5124 1.6574 11.2512 1.91839C10.99 2.17938 10.8061 2.50759 10.72 2.86667C10.6666 3.09867 10.6666 3.36 10.6666 3.66667V7C10.6666 7.30534 10.6666 7.568 10.7213 7.8C10.8071 8.15915 10.9907 8.48754 11.2517 8.74876C11.5127 9.00999 11.8409 9.19386 12.2 9.28C12.432 9.33334 12.6933 9.33334 13 9.33334H16.3333C16.6386 9.33334 16.9013 9.33334 17.1333 9.27867C17.4925 9.19285 17.8208 9.00927 18.0821 8.74828C18.3433 8.48729 18.5272 8.15908 18.6133 7.8C18.6666 7.568 18.6666 7.30667 18.6666 7V3.66667C18.6666 3.36134 18.6666 3.09867 18.612 2.86667C18.5262 2.50752 18.3426 2.17914 18.0816 1.91791C17.8206 1.65668 17.4924 1.47281 17.1333 1.38667C16.9013 1.33334 16.64 1.33334 16.3333 1.33334H13.0666ZM12.5106 2.68534C12.568 2.672 12.6573 2.66667 13.0666 2.66667H16.2666C16.6773 2.66667 16.7653 2.67067 16.8226 2.68534C16.9424 2.71398 17.0519 2.77524 17.139 2.86232C17.2261 2.9494 17.2873 3.0589 17.316 3.17867C17.3293 3.23467 17.3333 3.32267 17.3333 3.73334V6.93334C17.3333 7.344 17.328 7.432 17.3146 7.48934C17.286 7.60911 17.2247 7.71861 17.1377 7.80569C17.0506 7.89277 16.9411 7.95403 16.8213 7.98267C16.7653 7.996 16.6773 8 16.2666 8H13.0666C12.656 8 12.568 7.996 12.5106 7.98134C12.3909 7.95269 12.2814 7.89144 12.1943 7.80436C12.1072 7.71727 12.046 7.60778 12.0173 7.488C12.0053 7.43334 12 7.34534 12 6.93334V3.73334C12 3.32267 12.004 3.23467 12.0186 3.17734C12.0473 3.05756 12.1085 2.94806 12.1956 2.86098C12.2827 2.7739 12.3922 2.71264 12.512 2.684L12.5106 2.68534ZM3.66665 10.6667H6.99998C7.30531 10.6667 7.56798 10.6667 7.79998 10.7213C8.15913 10.8072 8.48751 10.9907 8.74874 11.2517C9.00996 11.5127 9.19384 11.8409 9.27998 12.2C9.33331 12.432 9.33331 12.6933 9.33331 13V16.3333C9.33331 16.6387 9.33331 16.9013 9.27865 17.1333C9.19283 17.4925 9.00925 17.8209 8.74826 18.0821C8.48727 18.3433 8.15905 18.5272 7.79998 18.6133C7.56798 18.6667 7.30665 18.6667 6.99998 18.6667H3.66665C3.36131 18.6667 3.09865 18.6667 2.86665 18.612C2.50749 18.5262 2.17911 18.3426 1.91789 18.0816C1.65666 17.8206 1.47279 17.4924 1.38665 17.1333C1.33331 16.9013 1.33331 16.64 1.33331 16.3333V13C1.33331 12.6947 1.33331 12.432 1.38798 12.2C1.4738 11.8409 1.65737 11.5125 1.91837 11.2512C2.17936 10.99 2.50757 10.8061 2.86665 10.72C3.09865 10.6667 3.35998 10.6667 3.66665 10.6667ZM3.73331 12C3.32265 12 3.23465 12.004 3.17731 12.0187C3.05754 12.0473 2.94804 12.1086 2.86096 12.1956C2.77388 12.2827 2.71262 12.3922 2.68398 12.512C2.67198 12.5667 2.66665 12.6547 2.66665 13.0667V16.2667C2.66665 16.6773 2.67065 16.7653 2.68531 16.8227C2.71395 16.9424 2.77521 17.0519 2.86229 17.139C2.94937 17.2261 3.05887 17.2874 3.17865 17.316C3.23465 17.3293 3.32265 17.3333 3.73331 17.3333H6.93331C7.34398 17.3333 7.43198 17.328 7.48931 17.3147C7.60909 17.286 7.71858 17.2248 7.80566 17.1377C7.89275 17.0506 7.954 16.9411 7.98265 16.8213C7.99598 16.7653 7.99998 16.6773 7.99998 16.2667V13.0667C7.99998 12.656 7.99598 12.568 7.98131 12.5107C7.95267 12.3909 7.89141 12.2814 7.80433 12.1943C7.71725 12.1072 7.60775 12.046 7.48798 12.0173C7.43331 12.0053 7.34531 12 6.93331 12H3.73331ZM13.0666 10.6667H13C12.6946 10.6667 12.432 10.6667 12.2 10.7213C11.8408 10.8072 11.5124 10.9907 11.2512 11.2517C10.99 11.5127 10.8061 11.8409 10.72 12.2C10.6666 12.432 10.6666 12.6933 10.6666 13V16.3333C10.6666 16.6387 10.6666 16.9013 10.7213 17.1333C10.8071 17.4925 10.9907 17.8209 11.2517 18.0821C11.5127 18.3433 11.8409 18.5272 12.2 18.6133C12.432 18.668 12.6946 18.668 13 18.668H16.3333C16.6386 18.668 16.9013 18.668 17.1333 18.6133C17.4922 18.5273 17.8203 18.3436 18.0813 18.0827C18.3423 17.8217 18.5259 17.4936 18.612 17.1347C18.6666 16.9027 18.6666 16.64 18.6666 16.3347V13C18.6666 12.6947 18.6666 12.432 18.612 12.2C18.5262 11.8409 18.3426 11.5125 18.0816 11.2512C17.8206 10.99 17.4924 10.8061 17.1333 10.72C16.9013 10.6667 16.64 10.6667 16.3333 10.6667H13.0666ZM12.5106 12.0187C12.568 12.0053 12.6573 12 13.0666 12H16.2666C16.6773 12 16.7653 12.004 16.8226 12.0187C16.9424 12.0473 17.0519 12.1086 17.139 12.1956C17.2261 12.2827 17.2873 12.3922 17.316 12.512C17.3293 12.568 17.3333 12.656 17.3333 13.0667V16.2667C17.3333 16.6773 17.328 16.7653 17.3146 16.8227C17.286 16.9424 17.2247 17.0519 17.1377 17.139C17.0506 17.2261 16.9411 17.2874 16.8213 17.316C16.7653 17.3293 16.6773 17.3333 16.2666 17.3333H13.0666C12.656 17.3333 12.568 17.328 12.5106 17.3147C12.3909 17.286 12.2814 17.2248 12.1943 17.1377C12.1072 17.0506 12.046 16.9411 12.0173 16.8213C12.0053 16.7667 12 16.6787 12 16.2667V13.0667C12 12.656 12.004 12.568 12.0186 12.5107C12.0473 12.3909 12.1085 12.2814 12.1956 12.1943C12.2827 12.1072 12.3922 12.046 12.512 12.0173L12.5106 12.0187Z" fill="#8094ae"/>
                          </svg>
                          dashboard</a>
                      </li>



                    </ul>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="row">


                  </div>
                  <div class="col-md-12">
                    <div class="left-content">
                      <div class="user-info">
                        <div class="user-info-header">
                          <form class="pic" action="users.php?page=avatupdate&id=<?php echo $userInfo['id'] ?>" method="post" enctype="multipart/form-data">
                            <?php
                                if (empty($userInfo['image']))
                                {
      ?>
                                <img src="<?php echo $avatar  ?>default.png" style="width: 100px;" alt="avart">

      <?php
                                }else {
                                  ?>
                                  <img src="<?php echo $avatar . $userInfo['image'] ?>" style="width: 100px;" alt="avart">

                                  <?php
                                }
                             ?>
                            <p class="username"><?php echo $userInfo['username'] ?></p>
                            <label for="avatar" class="avar-up">upload<i class="fas fa-plus"></i> </label>
                            <input type="file" id="avatar" name="avatar" class="up-ava" style="display:none;">
                            <input type="submit" name="upload" value="save" class="form-control btn btn-primary shw-btn" id="sb-bt">
                          </form>
                        </div>
                        <div class="user-info-body">
                          <ul style="text-align:right">
                            <li>
                              <p>full name: <?php echo $userInfo['fname'] ?> </p>

                            </li>
                            <li>
                              <p>email : <?php echo $userInfo['email'] ?></p>

                            </li>

                            <li>
                              <p>joined: <?php echo $userInfo['joined'] ?></p>

                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-7">
                  <div class="use-fl-info">
                    <form method="post" action="users.php?page=update">

    <div class="form-row">
      <?php
      if ($_SESSION['type'] ==  2 )
      {
?>
<div class="form-group col-md-6">
 <label for="">users subscrition</label>

 <select class="form-control" name="subs" >
   <option value="0" <?php if ($userInfo['subs'] == 0) { echo 'selected'; } ?>> basic </option>
   <option value="1" <?php if ($userInfo['subs'] == 1) { echo 'selected'; } ?>> stater </option>

   <option value="2" <?php if ($userInfo['subs'] == 2) { echo 'selected'; } ?>>Standered</option>

   <option value="3" <?php if ($userInfo['subs'] == 3) { echo 'selected'; } ?>>Pemium</option>
   <option value="4" <?php if ($userInfo['subs'] == 4) { echo 'selected'; } ?>>Unlimted</option>


 </select>
</div>
<?php
      }
       ?>
      <div class="form-group col-md-6">
        <label for="">points</label>
        <input type="text" name="points" class="form-control"  required  value="<?php  echo $userInfo['points'] ?>">
      </div>
      <div class="form-group col-md-6">
        <label for="">email</label>
        <input type="email" name="email" class="form-control"  required  value="<?php  echo $userInfo['email'] ?>">
      </div>
      <?php
      if ($_SESSION['type'] ==  2 )
      {
?>
<div class="form-group col-md-6">
 <label for="">users type</label>

 <select class="form-control" name="type" >
   <option value="2" <?php if ($userInfo['type'] == 2) { echo 'selected'; } ?>>admin</option>

   <option value="1" <?php if ($userInfo['type'] == 1) { echo 'selected'; } ?>>editor</option>
   <option value="0" <?php if ($userInfo['type'] == 0) { echo 'selected'; } ?>> client </option>

 </select>
</div>
<?php
      }
        ?>

      <div class="form-group col-md-6">
        <label for="">email</label>
        <input type="email" name="email" class="form-control"  required  value="<?php  echo $userInfo['email'] ?>">
      </div>
      <div class="form-group col-md-6">
        <label for="">username</label>
        <input type="text" name="username" class="form-control"  required  value="<?php  echo $userInfo['username'] ?>" >
      </div>
<input type="hidden" value="<?php echo $userInfo['id'] ?>" name="id" value="">
      <div class="form-group col-md-6">
        <label for="">password </label>
        <input type="password" name="password" class="form-control"   >
      </div>
      <div class="form-group col-md-6">
        <label for="inputPassword4">confirm new password</label>
        <input type="password" name="cpassword" class="form-control"  >
      </div>

            <div class="form-group col-md-6">
              <label for="">phone</label>
              <input type="text" name="phone" class="form-control"  required  value="<?php  echo $userInfo['phone'] ?>">
            </div>

      <div class="form-group col-md-6">
        <label for="">full name</label>
        <input type="text" name="fname" class="form-control"  required  value="<?php  echo $userInfo['fname'] ?>">
      </div>


        <div class="form-group col-md-6">
          <label for="">country</label>
          <input type="text" name="country" class="form-control"  required  value="<?php  echo $userInfo['country'] ?>" >
        </div>
        <div class="form-group col-md-6">
          <label for="">stats</label>
          <input type="text" name="stats" class="form-control"  required  value="<?php  echo $userInfo['stats'] ?>" >
        </div>



        <div class="form-group col-md-6">
          <label for="">city</label>
          <input type="text" name="city" class="form-control"  required  value="<?php  echo $userInfo['city'] ?>" >
        </div>


          <div class="form-group col-md-6">
            <label for="">adress</label>
            <input type="text" name="adress" class="form-control"  required  value="<?php  echo $userInfo['adress'] ?>" >
          </div>
          <div class="form-group col-md-6">
            <label for="">zip</label>
            <input type="text" name="zip" class="form-control"  required  value="<?php  echo $userInfo['zip'] ?>" >
          </div>


    </div>

    <button type="submit" class="btn btn-primary">save</button>
  </form>
                  </div>
                </div>

              </div>
            </div>
          </div>
          <?php





          ?>

          <?php
        }else {
          header('location: index.php');
        }
          ?>

          <?php


      }
      else {
        header('location: users.php');
      }
      ?>


      <?php

      include $tpl . 'footer.php';
    }elseif ($page == 'avatupdate') {

      include 'init.php';

      $id = isset($_GET['id']) && is_numeric($_GET['id']) ? intval($_GET['id']) : header('location: users.php');;


        $imageName = $_FILES['avatar']['name'];
        $imageSize = $_FILES['avatar']['size'];
        $imageTmp = $_FILES['avatar']['tmp_name'];
        $imageType = $_FILES['avatar']['type'];

        $imageAllowedExtension = array("jpeg", "jpg", "png");
        $Infunc = explode('.', $imageName);
        $imageExtension = strtolower(end($Infunc));
        $formErrors = array();
        if (empty($imageName))
        {
          $formErrors[] = 'user avatar  cant be empty';
        }
        if (!empty($imageName) && ! in_array($imageExtension, $imageAllowedExtension))
        {
          $formErrors[] = 'avatar Extension is not allowed';
        }
        if ($imageSize > 4194304)
        {
          $formErrors[] = 'avatar size cant be empty';
        }


                                      foreach ($formErrors as $error ) {
                                        ?>
                                        <div class="container">
                                            <?php
                                              echo '<div class="alert alert-danger" style="width: 50%;">' . $error . '</div>';
                                             ?>

                                        </div>
                                        <?php
                                      }



                                                                      if (empty($formErrors))
                                                                      {
                                                                        $image = rand(0,100000) . '_' . $imageName;
                                                                        move_uploaded_file($imageTmp, $avatar . '/' . $image);
                                                                        $stmt = $conn->prepare("UPDATE users SET image = ? WHERE id = ? LIMIT 1 ");
                                                                        $stmt->execute(array($image,$id));
                                                                        ?>

                                                                        <?php
                                                                        header('location: ' . $_SERVER['HTTP_REFERER']);
                                                                      }


                                                                      include $tpl . 'footer.php';
    }

    elseif ($page == 'update') {


      $pageTitle = 'update page';
      include 'init.php';
      $id = $_POST['id'];

                            $stmt = $conn->prepare("SELECT * FROM users WHERE id = ? LIMIT 1");
                            $stmt->execute(array($id));
                            $checkIfuser = $stmt->rowCount();

                            if($_SERVER['REQUEST_METHOD'] == 'POST')
                            {
                              $type = $_POST['type'];
                              $email = $_POST['email'];
                              $username = $_POST['username'];
                              $pass = $_POST['password'];
                              $cpass = $_POST['cpassword'];
                              $phone = $_POST['phone'];
                              $fname = $_POST['fname'];

                              $city = $_POST['city'];
                              $country = $_POST['country'];
                              $zip = $_POST['zip'];
                              $adress = $_POST['adress'];
                              $stats = $_POST['stats'];
                              $subs = $_POST['subs'];

                              $points = $_POST['points'];

                            $formErrors = array();
                            if (empty($username))
                            {
                              $formErrors[] = 'username is required';
                            }

                            if (empty($pass))
                            {
                              $stmt=$conn->prepare("SELECT password FROM users WHERE id = ? LIMIT 1");
                              $stmt->execute(array($id));
                              $passs = $stmt->fetch();

                              $password = $passs['password'];
                            }
                            if(!empty($pass))
                            {
                                if ($pass!=$cpass)
                                {
                                  $formErrors[] = 'passwords not match';
                                }
                                else {
                                  $password = sha1($_POST['cpassword']);
                                }
                            }

                            if (empty($email))
                            {
                              $formErrors[] = 'email is required';
                            }

                            if (empty($adress))
                            {
                              $formErrors[] = 'adress is required';
                            }
                            if (empty($city))
                            {
                              $formErrors[] = 'city is required';
                            }

                            foreach ($formErrors as $error ) {
                              ?>
                              <div class="container">
                                  <?php
                                    echo '<div class="alert alert-danger" style="width: 50%;">' . $error . '</div>';
                                   ?>

                              </div>
                              <?php
                              // header('refresh:4;url=' . $_SERVER['HTTP_REFERER']);
                            }
                            ?>
                              <div class="container" style="text-align:center">
                                <a href="users.php?page=edit&id=<?php echo $id ?>"> back</a>
                              </div>
                            <?php

                            if (empty($formErrors))
                            {
                              $stmt = $conn->prepare("UPDATE users SET username = ?, password = ?,  fname = ?, phone = ?,city = ?, email =?,type=?,subs =?,points= ?, country = ?, stats= ?, adress= ?, zip =?, br =?
                                 WHERE id= ? LIMIT 1  ");
                              $stmt->execute(array($username,$password,$fname,$phone,$city, $email,$type,$subs,$points, $country,$stats,$adress,$zip,$br,$id));

                              header('location: ' . $_SERVER['HTTP_REFERER']);
                            }
                          }


      include $tpl . 'footer.php';


    }elseif ($page == 'delete') {
     include 'init.php';
      if ($_SESSION['type'] == 2)
      {
        $id = isset($_GET['id']) && is_numeric($_GET['id']) ? intval($_GET['id']) : header('location: users.php');;
        $stmt = $conn->prepare("SELECT * FROM users WHERE id = ? LIMIT 1");
        $stmt->execute(array($id));
        $pfl = $stmt->fetch();
        $check = $stmt->rowCount();


          $stmt = $conn->prepare("DELETE FROM users WHERE id = :zid");
          $stmt->bindParam(":zid", $id);
          $stmt->execute();
          header('location: users.php');



      }
    }elseif ($page == 'activate') {
      if (isset($_SESSION['type']) == 2)
      {
        include 'init.php';
        $id = isset($_GET['id']) && is_numeric($_GET['id']) ? intval($_GET['id']) : header('location: users.php');;

          $stmt = $conn->prepare("UPDATE users SET status = 1 WHERE id= ? LIMIT 1  ");
          $stmt->execute(array($id));
          header('location:users.php');
      }
    }
    elseif ($page == 'deactivate') {
      if (isset($_SESSION['type']) == 2)
      {
        include 'init.php';
        $id = isset($_GET['id']) && is_numeric($_GET['id']) ? intval($_GET['id']) : header('location: users.php');;

          $stmt = $conn->prepare("UPDATE users SET status = 0 WHERE id= ? LIMIT 1  ");
          $stmt->execute(array($id));
          header('location:users.php');
      }
    }

    else {
      header('location: dashboard.php');
    }

    ?>


    <?php


  }else {
    header('location: logout.php');
  }
  ob_end_flush();
 ?>
